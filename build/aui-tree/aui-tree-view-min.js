AUI.add("aui-tree-view",function(ac){var U=ac.Lang,ar=U.isBoolean,aw=U.isString,r="boundingBox",e="children",a="container",Z="content",t="contentBox",T=".",ap="file",C="hitarea",R="icon",b="invalid",ag="label",P="lastSelected",au="leaf",q="node",W="ownerTree",H="root",s=" ",g="tree",D="tree-node",N="tree-view",f="type",z="view",ax=function(){return Array.prototype.slice.call(arguments).join(s);},al=function(A){return(A instanceof ac.TreeNode);},B=ac.getClassName,ao=B(g,C),y=B(g,R),j=B(g,ag),w=B(g,q,Z),u=B(g,q,Z,b),m=B(g,H,a),ah=B(g,z,Z);var Q=ac.Component.create({NAME:N,ATTRS:{type:{value:ap,validator:aw},lastSelected:{value:null,validator:al},lazyLoad:{validator:ar,value:true},io:{value:null},paginator:{value:null}},AUGMENTS:[ac.TreeData],prototype:{CONTENT_TEMPLATE:"<ul></ul>",initializer:function(){var A=this;var L=A.get(r);L.setData(N,A);},bindUI:function(){var A=this;A._delegateDOM();},renderUI:function(){var A=this;A._renderElements();},_createFromHTMLMarkup:function(L){var A=this;L.all("> li").each(function(aD){var aC=aD.one("> *").remove();var aB=aC.outerHTML();var aA=aD.one("> ul");var aE=new ac.TreeNode({boundingBox:aD,container:aA,label:aB,leaf:!aA,ownerTree:A});if(aA){aE.render();A._createFromHTMLMarkup(aA);}else{aE.render();}var az=aD.get(d).get(d);var aF=az.getData(D);if(!ac.instanceOf(aF,ac.TreeNode)){aF=az.getData(N);}aF.appendChild(aE);});},_createNodeContainer:function(){var A=this;var L=A.get(t);A.set(a,L);return L;},_renderElements:function(){var A=this;var L=A.get(t);var az=A.get(e);var aA=A.get(f);var aB=B(g,aA);L.addClass(ah);L.addClass(ax(aB,m));if(!az.length){A._createFromHTMLMarkup(L);}},_delegateDOM:function(){var A=this;var L=A.get(r);L.delegate("click",ac.bind(A._onClickHitArea,A),T+ao);L.delegate("dblclick",ac.bind(A._onClickHitArea,A),T+y);L.delegate("dblclick",ac.bind(A._onClickHitArea,A),T+j);L.delegate("mouseenter",ac.bind(A._onMouseEnterNodeEl,A),T+w);L.delegate("mouseleave",ac.bind(A._onMouseLeaveNodeEl,A),T+w);L.delegate("click",ac.bind(A._onClickNodeEl,A),T+w);},_onClickNodeEl:function(L){var A=this;var aA=A.getNodeByChild(L.currentTarget);if(aA&&!aA.isSelected()){var az=A.get(P);if(az){az.unselect();}aA.select();}},_onMouseEnterNodeEl:function(L){var A=this;var az=A.getNodeByChild(L.currentTarget);if(az){az.over();}},_onMouseLeaveNodeEl:function(L){var A=this;var az=A.getNodeByChild(L.currentTarget);if(az){az.out();}},_onClickHitArea:function(L){var A=this;var az=A.getNodeByChild(L.currentTarget);if(az){az.toggle();}}}});ac.TreeView=Q;var M=U.isNumber,ad="above",c="append",af="below",an="block",ai="body",av="clearfix",ab="default",v="display",ak="down",x="drag",n="draggable",Y="dragCursor",aq="dragNode",i="expanded",o="helper",at="insert",F="offsetHeight",d="parentNode",ay="scrollDelay",O="state",aj="tree-drag-drop",am="up",K=ac.DD.DDM,ae=B(o,av),k=B(R),aa=B(g,x,o),p=B(g,x,o,Z),J=B(g,x,o,ag),G=B(g,x,at,ad),X=B(g,x,at,c),I=B(g,x,at,af),l=B(g,x,O,c),S=B(g,x,O,at,ad),V=B(g,x,O,at,af),E='<div class="'+aa+'">'+'<div class="'+[p,ae].join(s)+'">'+'<span class="'+k+'"></span>'+'<span class="'+J+'"></span>'+"</div>"+"</div>";var h=ac.Component.create({NAME:aj,ATTRS:{helper:{value:null},scrollDelay:{value:100,validator:M}},EXTENDS:ac.TreeView,prototype:{direction:af,dropAction:null,lastY:0,node:null,nodeContent:null,destructor:function(){var A=this;var L=A.get(o);if(L){L.remove(true);}if(A.ddDelegate){A.ddDelegate.destroy();}},bindUI:function(){var A=this;ac.TreeViewDD.superclass.bindUI.apply(this,arguments);A._bindDragDrop();},renderUI:function(){var A=this;ac.TreeViewDD.superclass.renderUI.apply(this,arguments);var L=ac.Node.create(E).hide();ac.one(ai).append(L);A.set(o,L);K.set(Y,ab);},_bindDragDrop:function(){var A=this;var az=A.get(r);A._createDragInitHandler=function(){A.ddDelegate=new ac.DD.Delegate({bubbleTargets:A,container:az,invalid:T+u,nodes:T+w,target:true});var aA=A.ddDelegate.dd;aA.plug(ac.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false,borderStyle:null}).plug(ac.Plugin.DDNodeScroll,{scrollDelay:A.get(ay),node:az});aA.removeInvalid("a");L.detach();};var L=az.on(["focus","mousedown","mousemove"],A._createDragInitHandler);A.on("drag:align",A._onDragAlign);A.on("drag:start",A._onDragStart);A.on("drop:exit",A._onDropExit);A.after("drop:hit",A._afterDropHit);A.on("drop:hit",A._onDropHit);A.on("drop:over",A._onDropOver);},_appendState:function(L){var A=this;A.dropAction=c;A.get(o).addClass(l);L.addClass(X);},_goingDownState:function(L){var A=this;A.dropAction=af;A.get(o).addClass(V);L.addClass(I);},_goingUpState:function(L){var A=this;A.dropAction=ad;A.get(o).addClass(S);L.addClass(G);},_resetState:function(L){var A=this;var az=A.get(o);az.removeClass(l);az.removeClass(S);az.removeClass(V);if(L){L.removeClass(G);L.removeClass(X);L.removeClass(I);}},_updateNodeState:function(A){var aI=this;var aE=A.drag;var aB=A.drop;var L=aB.get(q);var aH=L.get(d);var aD=aE.get(q).get(d);var aA=aH.getData(D);aI._resetState(aI.nodeContent);if(!aD.contains(aH)){var aJ=L.get(F)/3;var az=L.getY();var aG=az+aJ;var aF=az+aJ*2;var aC=aE.mouseXY[1];if((aC>az)&&(aC<aG)){aI._goingUpState(L);}else{if(aC>aF){aI._goingDownState(L);}else{if((aC>aG)&&(aC<aF)){if(aA&&!aA.isLeaf()){aI._appendState(L);}else{if(aI.direction===am){aI._goingUpState(L);}else{aI._goingDownState(L);}}}}}}aI.nodeContent=L;},_afterDropHit:function(aB){var A=this;var aD=A.dropAction;var aC=aB.drag.get(q).get(d);var az=aB.drop.get(q).get(d);var aE=az.getData(D);var aA=aC.getData(D);var L=A.getEventOutputMap(A);L.tree.dropNode=aE;L.tree.dragNode=aA;if(aD===ad){aE.insertBefore(aA);A.bubbleEvent("dropInsert",L);}else{if(aD===af){aE.insertAfter(aA);A.bubbleEvent("dropInsert",L);}else{if(aD===c){if(aE&&!aE.isLeaf()){aE.appendChild(aA);if(!aE.get(i)){aE.expand();}A.bubbleEvent("dropAppend",L);}}}}A._resetState(A.nodeContent);A.bubbleEvent("drop",L);A.dropAction=null;},_onDragAlign:function(az){var A=this;var L=A.lastY;var aA=az.target.lastXY[1];if(aA!==L){A.direction=(aA<L)?am:ak;}A.lastY=aA;},_onDragStart:function(aC){var A=this;
var aA=aC.target;var aE=aA.get(q).get(d);var az=aE.getData(D);var aD=A.get(P);if(aD){aD.unselect();}az.select();var aB=A.get(o);var L=aB.one(T+J);aB.setStyle(v,an).show();L.html(az.get(ag));aA.set(aq,aB);},_onDropOver:function(L){var A=this;A._updateNodeState(L);},_onDropHit:function(L){var A=L.drop.get(q).get(d);var az=A.getData(D);if(!al(az)){L.preventDefault();}},_onDropExit:function(){var A=this;A.dropAction=null;A._resetState(A.nodeContent);}}});ac.TreeViewDD=h;},"@VERSION@",{requires:["aui-tree-node","dd-delegate","dd-proxy"],skinnable:true});