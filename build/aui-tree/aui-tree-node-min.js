AUI.add("aui-tree-node",function(aj){var ad=aj.Lang,aS=ad.isString,aI=ad.isBoolean,a1="alwaysShowHitArea",U="",u="boundingBox",h="children",aO="clearfix",z="collapsed",a="container",ah="content",x="contentBox",o="draggable",k="expanded",r="helper",aa="hidden",g="hitAreaEl",N="hitarea",Y="icon",a0="iconEl",d="invalid",az="id",ap="label",ab="labelEl",X="lastSelected",aN="leaf",s="node",ar="over",ae="ownerTree",f="parentNode",aF="radio",aY="rendered",aM="selected",v=" ",i="tree",O="tree-node",aW=function(){return Array.prototype.slice.call(arguments).join(v);},aw=function(A){return(A instanceof aj.TreeNode);},aU=function(A){return(A instanceof aj.TreeView);},K=aj.getClassName,am=K(r,aO),D=K(i,z),b=K(i,a),aH=K(i,x),a2=K(i,k),w=K(i,aa),aB=K(i,N),J=K(i,Y),l=K(i,ap),aK=K(i,s),I=K(i,s,ah),E=K(i,s,ah,d),aC=K(i,s,aa,N),j=K(i,s,aN),aR=K(i,s,ar),P=K(i,s,aM),ai='<div class="'+aB+'"></div>',t='<div class="'+J+'"></div>',e='<div class="'+l+'"></div>',aZ="<ul></ul>",y='<li class="'+aK+'"></li>',af='<div class="'+aW(am,I)+'"></div>';var S=aj.Component.create({NAME:O,ATTRS:{boundingBox:{valueFn:function(){return aj.Node.create(y);}},contentBox:{valueFn:function(){return aj.Node.create(af);}},draggable:{value:true,validator:aI},ownerTree:{value:null},label:{value:U,validator:aS},expanded:{value:false,validator:aI},id:{validator:aS},leaf:{value:true,setter:function(A){if(A&&this.get(h).length){return false;}return A;},validator:aI},nextSibling:{getter:"_getSibling",value:null,validator:aw},prevSibling:{getter:"_getSibling",value:null,validator:aw},parentNode:{value:null,validator:function(A){return aw(A)||aU(A);}},labelEl:{setter:aj.one,valueFn:function(){var A=this.get(ap);return aj.Node.create(e).html(A).unselectable();}},hitAreaEl:{setter:aj.one,valueFn:function(){return aj.Node.create(ai);}},alwaysShowHitArea:{value:true,validator:aI},iconEl:{setter:aj.one,valueFn:function(){return aj.Node.create(t);}},tabIndex:{value:null},rendered:{validator:aI,value:false}},AUGMENTS:[aj.TreeData],EXTENDS:aj.Base,prototype:{BOUNDING_TEMPLATE:y,CONTENT_TEMPLATE:af,initializer:function(){var A=this;var L=A.get(u);L.setData(O,A);A._syncTreeNodeBBId();A._uiSetDraggable(A.get(o));A._uiSetExpanded(A.get(k));A._uiSetLeaf(A.get(aN));},bindUI:function(){var A=this;A.after("childrenChange",aj.bind(A._afterSetChildren,A));A.after("draggableChange",aj.bind(A._afterDraggableChange,A));A.after("expandedChange",aj.bind(A._afterExpandedChange,A));A.after("idChange",A._afterSetId,A);A.after("leafChange",aj.bind(A._afterLeafChange,A));},render:function(L){var A=this;if(!A.get(aY)){A.renderUI();A.bindUI();A.syncUI();A.set(aY,true);}if(L){A.get(u).appendTo(L);}},renderUI:function(){var A=this;A._renderBoundingBox();A._renderContentBox();},syncUI:function(){var A=this;A._syncHitArea(A.get(h));},_afterExpandedChange:function(L){var A=this;A._uiSetExpanded(L.newVal);},_afterLeafChange:function(L){var A=this;A._uiSetLeaf(L.newVal);},_afterSetChildren:function(L){var A=this;A._syncHitArea(L.newVal);},_renderContentBox:function(a6){var A=this;var L=A.get(x);if(!A.isLeaf()){var a5=A.get(k);L.addClass(a5?a2:D);if(a5){A.expand();}}return L;},_renderBoundingBox:function(){var A=this;var a5=A.get(u);var L=A.get(x);var a6=null;L.append(A.get(a0));L.append(A.get(ab));a5.append(L);var a6=A.get(a);if(a6){if(!A.get(k)){a6.addClass(w);}a5.append(a6);}return a5;},_createNodeContainer:function(){var A=this;var L=A.get(a)||aj.Node.create(aZ);L.addClass(b);A.set(a,L);return L;},_syncHitArea:function(L){var A=this;if(A.get(a1)||L.length){A.showHitArea();}else{A.hideHitArea();A.collapse();}},appendChild:function(){var A=this;if(!A.isLeaf()){aj.TreeNode.superclass.appendChild.apply(A,arguments);}},collapse:function(){var A=this;A.set(k,false);},collapseAll:function(){var A=this;aj.TreeNode.superclass.collapseAll.apply(A,arguments);A.collapse();},contains:function(A){return A.isAncestor(this);},expand:function(){var A=this;A.set(k,true);},expandAll:function(){var A=this;aj.TreeNode.superclass.expandAll.apply(A,arguments);A.expand();},getDepth:function(){var a5=0;var L=this;var A=L.get(f);while(A){++a5;A=A.get(f);}return a5;},hasChildNodes:function(){var A=this;return(!A.isLeaf()&&aj.TreeNode.superclass.hasChildNodes.apply(this,arguments));},isSelected:function(){return this.get(x).hasClass(P);},isLeaf:function(){var A=this;return A.get(aN);},isAncestor:function(a5){var L=this;var A=L.get(f);while(A){if(A===a5){return true;}A=A.get(f);}return false;},toggle:function(){var A=this;if(A.get(k)){A.collapse();}else{A.expand();}},select:function(){var A=this;var L=A.get(ae);if(L){L.set(X,A);}A.get(x).addClass(P);A.fire("select");},unselect:function(){var A=this;A.get(x).removeClass(P);A.fire("unselect");},_afterDraggableChange:function(L){var A=this;A._uiSetDraggable(L.newVal);A.syncUI();},over:function(){this.get(x).addClass(aR);},out:function(){this.get(x).removeClass(aR);},showHitArea:function(){var A=this;var L=A.get(g);L.removeClass(aC);},hideHitArea:function(){var A=this;var L=A.get(g);L.addClass(aC);},_syncTreeNodeBBId:function(L){var A=this;A.get(u).attr(az,A.get(az));},_getSibling:function(a7,L){var A=this;var a6="_"+L;var a5=A[a6];if(a5!==null&&!aw(a5)){a5=null;A[a6]=a5;}return a5;},_uiSetDraggable:function(a5){var A=this;var L=A.get(x);L.toggleClass(E,!a5);},_uiSetExpanded:function(a6){var A=this;if(!A.isLeaf()){var a5=A.get(a);var L=A.get(x);if(a6){L.replaceClass(D,a2);if(a5){a5.removeClass(w);}}else{L.replaceClass(a2,D);if(a5){a5.addClass(w);}}}},_uiSetLeaf:function(a5){var A=this;var L=A.get(x);if(a5){A.get(a).remove();A.get(g).remove();}else{L.prepend(A.get(g));A._createNodeContainer();A._uiSetExpanded(A.get(k));}L.toggleClass(j,a5);}}});aj.TreeNode=S;var aE=ad.isFunction,M=ad.isObject,ak=ad.isValue,aT="cache",aA="end",aq="io",aJ="limit",aX="loaded",a3="loading",ao="paginator",au="start",ay="tree-node-io",c="paginatorClick",aG=K(i,s,ao),C=K(i,s,aq,a3),aD='<a class="'+aG+'" href="javascript:void(0);">Load more results</a>';var R=aj.Component.create({NAME:ay,ATTRS:{io:{lazyAdd:false,value:null,setter:function(A){return this._setIO(A);
}},loading:{value:false,validator:aI},loaded:{value:false,validator:aI},cache:{value:true,validator:aI},leaf:{value:false,validator:aI},paginator:{setter:function(A){return aj.merge({alwaysVisible:false,autoFocus:true,element:aj.Node.create(aD),endParam:aA,limitParam:aJ,start:0,startParam:au},A);},validator:M}},EXTENDS:aj.TreeNode,prototype:{bindUI:function(){var A=this;aj.TreeNodeIO.superclass.bindUI.apply(this,arguments);A._bindPaginatorUI();A._createEvents();},syncUI:function(){var A=this;aj.TreeNodeIO.superclass.syncUI.apply(this,arguments);A._syncPaginatorUI();},_bindPaginatorUI:function(){var A=this;var a5=A.get(ao);if(a5){var L=aj.bind(A._handlePaginatorClickEvent,A);a5.element.on("click",L);}},createNodes:function(L){var A=this;aj.Array.each(aj.Array(L),function(a6){var a5=A.createNode.call(A,a6);A.appendChild(a5);});A._syncPaginatorUI(L);},expand:function(){var A=this;var L=A.get(aT);var a7=A.get(aq);var a5=A.get(aX);var a6=A.get(a3);if(!L){A.set(aX,false);}if(a7&&!a5&&!a6&&!this.hasChildNodes()){if(!L){A.empty();}A.initIO();}else{aj.TreeNodeIO.superclass.expand.apply(this,arguments);}},initIO:function(){var L=this;var a5=L.get(aq);if(aE(a5.cfg.data)){a5.cfg.data=a5.cfg.data.call(L,L);}L._syncPaginatorIOData(a5);if(aE(a5.loader)){var A=aj.bind(a5.loader,L);A(a5.url,a5.cfg,L);}else{aj.io.request(a5.url,a5.cfg);}},ioStartHandler:function(){var A=this;var L=A.get(x);A.set(a3,true);L.addClass(C);},ioCompleteHandler:function(){var A=this;var L=A.get(x);A.set(a3,false);A.set(aX,true);L.removeClass(C);},ioSuccessHandler:function(){var bb=this;var a7=bb.get(aq);var ba=bb.get(ae);var a8=Array.prototype.slice.call(arguments);var a5=a8.length;var A=a8[1];if(a5>=3){var L=a8[2];try{A=aj.JSON.parse(L.responseText);}catch(a6){}}var a9=a7.formatter;if(a9){A=a9(A);}bb.createNodes(A);bb.expand();if(ba&&ba.ddDelegate){ba.ddDelegate.syncTargets();}},ioFailureHandler:function(){var A=this;A.set(a3,false);A.set(aX,false);},_createEvents:function(){var A=this;A.publish(c,{defaultFn:A._defPaginatorClickFn,prefix:ay});},_defPaginatorClickFn:function(L){var A=this;var a5=A.get(ao);if(ak(a5.limit)){a5.start+=a5.limit;}if(A.get(aq)){A.initIO();}},_handlePaginatorClickEvent:function(a6){var A=this;var a5=A.get(ae);var L=A.getEventOutputMap(A);A.fire(c,L);if(a5){a5.fire(c,L);}a6.halt();},_inheritOwnerTreeAttrs:function(){var L=this;var a5=L.get(ae);if(a5){if(!L.get(aq)){L.set(aq,aj.clone(a5.get(aq)));}if(!L.get(ao)){var A=a5.get(ao);if(A&&A.element){A.element=A.element.clone();}L.set(ao,A);}}},_setIO:function(a5){var A=this;if(!a5){return null;}else{if(aS(a5)){a5={url:a5};}}a5=a5||{};a5.cfg=a5.cfg||{};a5.cfg.on=a5.cfg.on||{};var L={start:aj.bind(A.ioStartHandler,A),complete:aj.bind(A.ioCompleteHandler,A),success:aj.bind(A.ioSuccessHandler,A),failure:aj.bind(A.ioFailureHandler,A)};aj.each(L,function(a8,a6){var a9=a5.cfg.on[a6];if(aE(a9)){var a7=function(){a8.apply(A,arguments);a9.apply(A,arguments);};a5.cfg.on[a6]=aj.bind(a7,A);}else{a5.cfg.on[a6]=a8;}});return a5;},_syncPaginatorIOData:function(a6){var A=this;var a5=A.get(ao);if(a5&&ak(a5.limit)){var L=a6.cfg.data||{};L[a5.limitParam]=a5.limit;L[a5.startParam]=a5.start;L[a5.endParam]=(a5.start+a5.limit);a6.cfg.data=L;}},_syncPaginatorUI:function(a5){var a9=this;var L=a9.get(h);var ba=a9.get(ao);if(ba){var a8=true;if(a5){a8=(a5.length>0);}var A=ba.start;var a7=ba.total||L.length;var bb=a8&&(a7>L.length);if(ba.alwaysVisible||bb){a9.get(a).append(ba.element.show());if(ba.autoFocus){try{ba.element.focus();}catch(a6){}}}else{ba.element.hide();}}}}});aj.TreeNodeIO=R;var m="checkbox",q="checked",ag="checkContainerEl",aP="checkEl",T="checkName",ac=".",n="name",F="tree-node-check",an=K(i,s,m),av=K(i,s,m,a),ax=K(i,s,q),W='<div class="'+av+'"></div>',at='<input class="'+an+'" type="checkbox" />';var aL=aj.Component.create({NAME:F,ATTRS:{checked:{value:false,validator:aI},checkName:{value:F,validator:aS},checkContainerEl:{setter:aj.one,valueFn:function(){return aj.Node.create(W);}},checkEl:{setter:aj.one,valueFn:function(){var A=this.get(T);return aj.Node.create(at).attr(n,A);}}},EXTENDS:aj.TreeNodeIO,prototype:{initializer:function(){var A=this;A._uiSetChecked(A.get(q));},renderUI:function(){var L=this;aj.TreeNodeCheck.superclass.renderUI.apply(L,arguments);var a5=L.get(ab);var A=L.get(aP);var a6=L.get(ag);A.hide();a6.append(A);a5.placeBefore(a6);if(L.isChecked()){L.check();}},bindUI:function(){var A=this;var L=A.get(x);var a5=A.get(ab);aj.TreeNodeCheck.superclass.bindUI.apply(A,arguments);A.after("checkedChange",aj.bind(A._afterCheckedChange,A));L.delegate("click",aj.bind(A.toggleCheck,A),ac+av);L.delegate("click",aj.bind(A.toggleCheck,A),ac+l);a5.swallowEvent("dblclick");},check:function(L){var A=this;A.set(q,true,{originalTarget:L});},uncheck:function(L){var A=this;A.set(q,false,{originalTarget:L});},toggleCheck:function(){var L=this;var A=L.get(aP);var a5=A.attr(q);if(!a5){L.check();}else{L.uncheck();}},isChecked:function(){var A=this;return A.get(q);},_afterCheckedChange:function(L){var A=this;A._uiSetChecked(L.newVal);},_uiSetChecked:function(L){var A=this;if(L){A.get(x).addClass(ax);A.get(aP).attr(q,q);}else{A.get(x).removeClass(ax);A.get(aP).attr(q,U);}}}});aj.TreeNodeCheck=aL;var G="child",V="tree-node-task",Q="unchecked",aQ=function(A){return A instanceof aj.TreeNodeCheck;},al=K(i,s,G,Q);var a4=aj.Component.create({NAME:V,EXTENDS:aj.TreeNodeCheck,prototype:{check:function(a5){var A=this;var L=A.get(x);a5=a5||A;if(!A.isLeaf()){A.eachChildren(function(a6){if(aQ(a6)){a6.check(a5);}});}A.eachParent(function(a6){if(aQ(a6)&&!a6.isChecked()){a6.get(x).addClass(al);}});L.removeClass(al);aj.TreeNodeTask.superclass.check.call(this,a5);},uncheck:function(a5){var A=this;var L=A.get(x);a5=a5||A;if(!A.isLeaf()){A.eachChildren(function(a6){if(a6 instanceof aj.TreeNodeCheck){a6.uncheck(a5);}});}A.eachParent(function(a6){if(aQ(a6)&&!a6.isChecked()){a6.get(x).removeClass(al);}});L.removeClass(al);aj.TreeNodeTask.superclass.uncheck.call(this,a5);}}});aj.TreeNodeTask=a4;var H="tree-node-radio",p=function(A){return A instanceof aj.TreeNodeRadio;
},B=K(i,s,aF),Z=K(i,s,aF,q);var aV=aj.Component.create({NAME:H,EXTENDS:aj.TreeNodeTask,prototype:{renderUI:function(){var A=this;aj.TreeNodeRadio.superclass.renderUI.apply(A,arguments);A.get(x).addClass(B);},check:function(){var A=this;A._uncheckNodesRadio();aj.TreeNodeRadio.superclass.check.apply(this,arguments);},_uiSetChecked:function(L){var A=this;if(L){A.get(x).addClass(Z);A.get(aP).attr(q,q);}else{A.get(x).removeClass(Z);A.get(aP).attr(q,U);}},_uncheckNodesRadio:function(a6){var A=this;var a5;if(a6){a5=a6.get(h);}else{var L=A.get(ae);if(L){a5=L.get(h);}else{return;}}aj.Array.each(a5,function(a8,a7,a9){if(!a8.isLeaf()){A._uncheckNodesRadio(a8);}if(p(a8)){a8.uncheck();}});}}});aj.TreeNodeRadio=aV;aj.TreeNode.nodeTypes={radio:aj.TreeNodeRadio,task:aj.TreeNodeTask,check:aj.TreeNodeCheck,node:aj.TreeNode,io:aj.TreeNodeIO};},"@VERSION@",{requires:["aui-tree-data","aui-io","json","querystring-stringify"],skinnable:false});